import{d as $,r as d,n as f,a as U,g as _,b as p,c as x,f as e,u as s,e as r,F as N,i as j,w as u,x as B,A as R,q as h,t as b,j as z,D as E,G as D,s as P,C as H,y as V,z as A,I as q,E as F,_ as G}from"./index-gB8lYAtT.js";import{_ as K}from"./Navigation-Return-CUJ0SQdH.js";import{T as w}from"./TagLarger-DKgcNVCC.js";import{p as O,M as W}from"./MessageList-CQWDhQ3B.js";const J={class:"container"},Q={style:{"text-align":"left"}},X=["innerHTML"],Y={style:{"margin-top":"auto"}},Z={class:"btns",style:{display:"flex","justify-content":"space-around"}},ee={style:{"text-align":"center"},class:"context"},te={style:{width:"94%",margin:"0 auto 20px auto"},class:"gray"},ae={style:{display:"flex","flex-direction":"column",width:"100%",height:"fit-content"}},se=["src"],oe={style:{"text-align":"left"}},ne={style:{color:"#007bff",margin:"3%",width:"100%"}},le=["innerHTML"],ie={style:{"flex-grow":"1","margin-top":"3%","background-color":"white","border-radius":"10px",padding:"10px",margin:"5px"}},re={style:{left:"3%",width:"94%",height:"90%","max-width":"100%","word-break":"break-all"}},de=["innerHTML"],ue={class:"gray",id:"comment"},ce={class:"sendComment"},me=$({__name:"ExperimentSummary",setup(pe){let l=d(""),c=d(!1),g=d(1),v="";const y=d("Intro"),o=R(),C=f(()=>`/static/experiments/images/${o.params.id.slice(0,4)}/${o.params.id.slice(4,6)}/${o.params.id.slice(6,8)}/${o.params.id.slice(8,24)}/${a.value.Image||0}.jpg!full`),I=f(()=>`/static/users/avatars/${a.value.User.ID.slice(0,4)}/${a.value.User.ID.slice(4,6)}/${a.value.User.ID.slice(6,8)}/${a.value.User.ID.slice(8,24)}/${a.value.User.Avatar}.jpg!small.round`),a=d({Type:0,ParentID:null,ParentName:null,ParentCategory:null,ContentID:"642cf37a494746375aae306a",Editor:null,Coauthors:[],Description:["Loading..."],LocalizedDescription:null,Tags:["正在加载"],Visits:0,Stars:0,Supports:0,Remixes:0,Comments:0,Price:0,Popularity:0,ID:"642cf37a494746375aae306a",Category:"Discussion",Subject:"Loading...",LocalizedSubject:null,Image:0,ImageRegion:0,User:{ID:"0",Nickname:"Loading...",Signature:"Loading...",Avatar:0,AvatarRegion:0,Decoration:0,Verification:"Volunteer"}});U(async()=>{const n=await _("/Contents/GetSummary",{ContentID:o.params.id,Category:o.params.category});a.value=n.Data});function k(n){v=n.userID,l.value=`回复@${n.msg_title}: `}const S=async()=>{c.value=!0;const n=await _("/Messages/PostComment",{TargetID:o.params.id,TargetType:o.params.category,Content:l.value||"",ReplyID:v||"",Language:"from web",Special:null});if(n.Status==200)l.value="",g.value=Math.random();else if(n.Status==403&&n.Message.startsWith("Stopword.Blocked")){const t=Number("Stopword.Blocked.Details|0".slice("Stopword.Blocked.Details|0".indexOf("|")+1)),m=l.value.slice(t,10);F.emit("error",`您输入的内容“...${m}...”中包含不适合词句`,1)}c.value=!1},T=()=>{window.history.back()};return(n,t)=>{const m=h("n-button"),L=h("n-input");return p(),x("div",J,[e("div",{class:"cover",style:B({backgroundImage:`url(${C.value})`,backgroundRepeat:"no-repeat",backgroundSize:"cover"})},[e("div",Q,[e("img",{src:K,style:{width:"2.7em"},onClick:T}),e("div",{style:{color:"white","font-size":"clamp(1.6em ,3.5vw,2em)","text-align":"left",position:"relative","z-index":"30"},innerHTML:s(b)(a.value.Subject)},null,8,X),r(w,{tag:s(o).params.category,style:{color:"aquamarine","font-weight":"bold"}},null,8,["tag"]),(p(!0),x(N,null,j(a.value.Tags,(i,M)=>(p(),z(w,{key:M,tag:i},null,8,["tag"]))),128))]),e("div",Y,[t[4]||(t[4]=e("div",{id:"gap"},null,-1)),e("div",Z,[r(m,{type:"info",strong:"",round:"",disabled:"",style:{padding:"10px 10%",width:"80%"}},{default:u(()=>t[3]||(t[3]=[E(" 进入实验 ")])),_:1})])])],4),e("div",ee,[r(s(q),{value:y.value,"onUpdate:value":t[2]||(t[2]=i=>y.value=i),"justify-content":"space-evenly",type:"line"},{default:u(()=>[r(s(D),{name:"Intro",tab:"简介"},{default:u(()=>[e("div",te,[e("div",ae,[e("div",{style:{display:"flex",height:"60px","background-color":"white","border-radius":"10px",margin:"5px"},onClick:t[0]||(t[0]=i=>s(P)(a.value.User.ID))},[e("img",{src:I.value,style:{margin:"auto 10px",height:"90%","border-radius":"50%"}},null,8,se),e("div",oe,[e("p",ne,H(a.value.User.Nickname),1),e("p",{style:{color:"gray",margin:"0%",width:"100%"},innerHTML:s(b)(a.value.User.Signature)},null,8,le)])]),e("div",ie,[t[6]||(t[6]=e("h3",{style:{color:"#007bff","text-align":"left","margin-top":"2px","margin-bottom":"2px"}}," 实验介绍 ",-1)),e("div",re,[e("div",{style:{"text-align":"left"},innerHTML:s(O)(a.value.Description)},null,8,de),t[5]||(t[5]=e("div",{style:{"font-weight":"bold","text-align":"left"}},"字数统计:",-1))])])])])]),_:1}),r(s(D),{name:"Comment",tab:`评论(${a.value.Comments})`},{default:u(()=>[e("div",ue,[r(W,{ID:s(o).params.id,Category:s(o).params.category,upDate:s(g),onMsgClick:k},null,8,["ID","Category","upDate"]),e("div",ce,[r(L,{value:s(l),"onUpdate:value":t[1]||(t[1]=i=>V(l)?l.value=i:l=i),style:{"text-align":"left"},type:"text",placeholder:"发布一条友善的言论","show-count":"",maxlength:400,onKeyup:A(S,["enter"]),loading:s(c)},null,8,["value","loading"])])])]),_:1},8,["tab"])]),_:1},8,["value"])])])}}}),_e=G(me,[["__scopeId","data-v-e73a9022"]]);export{_e as default};
